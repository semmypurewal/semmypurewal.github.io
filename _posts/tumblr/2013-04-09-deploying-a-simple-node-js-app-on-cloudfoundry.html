---
layout: post
title: Deploying a Simple Node.js app on CloudFoundry
date: '2013-04-09T14:53:54-07:00'
tags: []
tumblr_url: http://blog.semmy.me/post/47553962398/deploying-a-simple-node-js-app-on-cloudfoundry
---
<p>Now we have an application that is made up of a twitter worker and an express application that serves up data. The next piece of the puzzle is deploying our application on the web. That used to require a lot of work, since we&#8217;d have to purchase server space, set up the server with required software, point a domain name to our application, etc. Times have changed a lot since then, and there are now services called &#8220;platforms-as-a-service&#8221; that take care of the hard work for you.</p>

<p>We&#8217;ll use <a target="_blank" href="http://cloudfoundry.com/">CloudFoundry</a>, the open-source platform as a service, but there are many other options including <a target="_blank" href="https://www.heroku.com/">Heroku</a> and <a target="_blank" href="https://www.nodejitsu.com/">Nodejitsu</a>. For CloudFoundry, you&#8217;ll start by signing up for an account <a target="_blank" href="https://my.cloudfoundry.com/signup">here</a>.</p>

<p>Next, we&#8217;ll set up the command-line client for CloudFoundry. To do so, we&#8217;ll need to start by installing Ruby. <a target="_blank" href="http://www.youtube.com/watch?v=umzkWPAUFYA">This video</a> walks you through installing Ruby (and the RedCar text editor)in both MacOS and Windows.</p>

<p>Once you have Ruby installed, open your ruby command prompt (which will just be your normal terminal window in MacOS, and in Windows you&#8217;ll have an application called &#8220;Open Command Prompt with Ruby&#8221;). Once there, install the vmc client using RubyGems:</p>

<pre class="code">$ sudo gem install vmc</pre>

<p>Now, let&#8217;s create a very simple Node.js program and deploy it. Let&#8217;s use the following program:</p>

<pre class="code">var http = require("http");

var server = http.createServer(function (req, res) {
    res.writeHeader({
        "Content-Type":"text/html"
    });
    res.end("Hello from CloudFoundry!");
}).listen(3000);</pre>

<p>Once we&#8217;re sure that our programming is correctly running locally, we&#8217;re ready to deploy it. To do this, we&#8217;ll open up our ruby command prompt and navigate to the directory storing the program. Once there, we&#8217;ll type a series of commands:</p>

<pre class="code">$ vmc target api.cloudfoundry.com
Setting target to <a href="https://api.cloudfoundry.com">https://api.cloudfoundry.com</a>... OK
$ vmc login
target: <a href="https://api.cloudfoundry.com">https://api.cloudfoundry.com</a>

Email&gt; youremail@example.com

Password&gt; *********

Authenticating... OK</pre>

<p>Now we&#8217;ll deploy using the push command. This will enter us into a dialogue with vmc.</p>

<pre class="code">$ vmc push
Name&gt; cloudfoundrytutorial

Instances&gt; 1

1: node
2: other
Framework&gt; node

1: node
2: node06
3: node08
4: other
Runtime&gt; 1

1: 64M
2: 128M
3: 256M
4: 512M
5: 1G
Memory Limit&gt; 64M

Creating cloudfoundrytutorial... OK

1: cloudfoundrytutorial.cloudfoundry.com
2: none
Domain&gt; cloudfoundrytutorial.cloudfoundry.com

Updating cloudfoundrytutorial... OK

Create services for application?&gt; n

Bind other services to application?&gt; n

Save configuration?&gt; n

Uploading cloudfoundrytutorial... OK
Starting cloudfoundrytutorial... OK
Checking cloudfoundrytutorial...
  0/1 instances: 1 starting
  1/1 instances: 1 running
OK</pre>

<p>Your answers will be the same, with the exception of the name. There can only be one application with any given name and URL on CloudFoundry, so if there&#8217;s a collision you will be notified.</p>

<p>Once you&#8217;re successful, you can point your browser to http://[the name you entered above].cloudfoundry.com and you should see your app running.</p>

<p>It&#8217;s probably helpful to check out the vmc help by simply typing vmc in your ruby command prompt. You should get a list of all CloudFoundry commands. One command you&#8217;ll probably use pretty often is the apps command. This shows a list of all of your deployed apps and their current statuses.</p>

<p>Next, we&#8217;ll see how to connect to CloudFoundry&#8217;s Redis instance. once our app is deployed.</p>
